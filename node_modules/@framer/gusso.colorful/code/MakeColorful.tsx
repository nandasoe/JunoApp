import * as React from 'react'
import * as _ from 'lodash'
import { toP3 } from './Utils'
import { Color } from 'framer'
import { box, text, arrow } from './EmptyState'

export const MakeColorful = props => {
  const { children } = props

  const clone = element => {
    const { props } = element
    let newProps = {}

    for (const key in props) {
      if (Color.isColor(props[key])) {
        newProps[key] = toP3(props[key])
      }

      if (typeof props[key] == 'object' && key != 'children')
        newProps[key] = _.cloneDeepWith(props[key], color => {
          if (Color.isColor(color)) return toP3(color)
        })
    }

    return React.cloneElement(
      element,
      newProps,
      React.Children.map(props.children, child => clone(child))
    )
  }

  return children.length ? (
    clone(children[0])
  ) : (
    <div style={box}>
      <div style={text}>Connect</div>
      <div style={arrow}>â†’</div>
    </div>
  )
}

MakeColorful.defaultProps = {
  width: 150,
  height: 150,
}
